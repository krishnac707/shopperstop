import React, { useEffect, useState } from 'react'
import { useNavigate, useParams } from 'react-router-dom';
import './SingleProduct.css'

const SingleProduct = () => {

    const { id } = useParams();
    const [allProduct, setAllProduct] = useState([]);
    const [singleProduct, setSingleProduct] = useState({});
    const [isUserLogin, updateUserLogin] = useState(false);
    const [currentEmail, setCurrentEmail] = useState("");
    const router = useNavigate();

    useEffect(() => {
        fetch('https://fakestoreapi.com/products')
            .then(res => res.json())
            .then(json => setAllProduct(json))
    }, [])

    useEffect(() => {
        if (id && allProduct.length) {
            const result = allProduct.find((product) => product.id == id)
            setSingleProduct(result);
        }
    }, [id, allProduct])

    useEffect(() => {
        const user = JSON.parse(localStorage.getItem("CurrentUser"));
        if (user) {
            updateUserLogin(true);
            setCurrentEmail(user.email);
        }
    }, [])

    function addToCart() {
        if (isUserLogin) {
            const users = JSON.parse(localStorage.getItem("Users"));
            // console.log(users,"single-page-all-user");
            for (let i = 0; i < users.length; i++) {
                if (users[i].email == currentEmail) {
                    users[i]?.cart.push(singleProduct);
                    localStorage.setItem("Users", JSON.stringify(users));
                    alert("product Added Successfully");
                    router('/all-products');
                    break;
                }
            }
        }
        else {
            alert("Please login first");
            router("/login");
        }
    }

    return (
        <>
            <div className='single-product-body'>
                <div className="single-product-main-body">
                    <div className="left-div">
                        <div className='left-div-single-product-image-one'>
                            <img src={singleProduct.image} alt="" />
                        </div>
                        <div className='left-div-single-product-image-one'>
                            <img src={singleProduct.image} alt="" />
                        </div>
                        <div className='left-div-single-product-image-one'>
                            <img src={singleProduct.image} alt="" />
                        </div>
                        <div className='left-div-single-product-image-one'>
                            <img src={singleProduct.image} alt="" />
                        </div>
                    </div>
                    <div className="right-div">
                        <h2>{singleProduct.title}</h2>
                        <h2 className='price-css'>$. {singleProduct.price}</h2>
                        <p>{singleProduct.description}</p>
                        <button className='button-single-product' onClick={addToCart}>Add to Cart</button>
                        {/* <p>{singleProduct.rating.rate}</p> */}
                        <h3 className='size-css'>Size</h3>
                        <div className='large-size-css'>
                            <div>
                                <span>small</span>
                            </div>
                            <div>
                                <span>LARGE</span>
                            </div>
                            <div>
                                <span>XXL</span>
                            </div>
                            <div>
                                <span>XXXL</span>
                            </div>
                        </div>

                        <div className="delivery-service-div">
                            <h3>Delivery Servie</h3>
                            <p>View available services for your pincode</p>
                            <div className='check-pincode-div'>
                                <input type="text" placeholder='Enter Pincode' />
                                <button>Check</button>
                            </div>
                            <div className="bus-div">
                                <div>
                                    <img src="data:image/svg+xml;charset=utf8,%3Csvg width='44' height='44' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M2.541 25.62c.182-.277.45-.402.776-.402H8.87c.134 0 .277.029.412.077.268.096.402.306.402.593 0 .288-.144.48-.412.594a1.406 1.406 0 0 1-.527.077H6.793c-.21 0-.326.057-.345.297-.086.967-.077.986.89.986.738 0 1.485-.01 2.222 0 .268.01.412-.086.527-.325.718-1.466 1.915-2.27 3.533-2.27 1.648 0 2.864.814 3.582 2.317.124.268.325.278.565.278h11.721c.536 0 .536 0 .536-.517V23.57c0-.144-.01-.287.02-.421.076-.326.287-.517.622-.517.316 0 .546.163.613.479.047.21.057.43.057.641.01 1.226 0 2.451.01 3.677 0 .125-.067.326.124.355.163.028.172-.163.22-.268.728-1.456 1.915-2.26 3.534-2.28 1.609-.019 2.806.766 3.543 2.203.153.297.316.402.641.402 1.102-.01 1.102 0 1.102-1.11 0-.374-.01-.738 0-1.112.01-.287-.106-.383-.383-.373a2.595 2.595 0 0 1-.9-.125c-.747-.258-1.178-.785-1.312-1.55-.087-.499-.067-.997-.048-1.495.029-.546.278-.766.842-.766.45 0 .891-.01 1.341 0 .316.01.316-.115.182-.335-.402-.66-1.005-.977-1.752-.986-2.26-.02-4.52 0-6.78-.01-.24 0-.354.086-.345.335a2.5 2.5 0 0 1-.048.46c-.076.326-.287.508-.622.508-.326.01-.584-.22-.632-.556-.02-.153-.02-.306-.02-.46V10.002c0-.508 0-.508-.507-.508H6.966c-.499 0-.499 0-.499.527v10.15c0 .192-.01.384-.048.575-.076.364-.344.565-.68.537-.335-.03-.565-.269-.593-.642-.01-.105-.01-.201-.01-.306V9.762c0-1.082.479-1.552 1.57-1.552h23.06c1.062 0 1.541.47 1.59 1.523.009.22.018.43 0 .651-.03.326.095.45.43.44 1.379-.019 2.758-.019 4.137 0 1.235.02 2.24.824 2.528 2.011.086.364.124.728.096 1.102-.01.2-.02.44-.182.565-.307.23-.24.488-.173.785.269 1.025.517 2.05.766 3.083.058.25.173.383.44.45 1.428.393 2.385 1.628 2.395 3.103.01 2.145.01 4.29 0 6.435 0 .575-.23.804-.814.814-.46.01-.92.01-1.379 0-.278-.01-.393.058-.43.374-.307 2.509-2.654 4.108-5.028 3.38-1.628-.498-2.548-1.676-2.787-3.361-.048-.326-.172-.393-.46-.383-4.29.01-8.58.01-12.87 0-.316 0-.43.086-.478.411-.288 1.81-1.446 3.074-3.103 3.429-2.25.478-4.5-1.16-4.702-3.457-.029-.307-.124-.393-.412-.383-.91.01-1.81.01-2.72 0-.947-.01-1.464-.537-1.474-1.475 0-.268-.01-.536 0-.804.01-.25-.096-.336-.345-.336-.46.01-.919 0-1.379 0-.354.01-.65-.095-.861-.392-.01-.201-.01-.374-.01-.556zm31.965-6.97c.919 0 1.838-.01 2.758 0 .296 0 .42-.058.335-.393-.278-1.044-.537-2.098-.795-3.151-.058-.249-.163-.364-.44-.364a371.4 371.4 0 0 1-4.626 0c-.306 0-.402.115-.402.402.01 1.025.01 2.04 0 3.065-.01.335.124.44.45.44.91-.01 1.82 0 2.72 0zm3.342 10.514c0-1.456-1.14-2.605-2.586-2.605a2.567 2.567 0 0 0-2.595 2.595c0 1.475 1.12 2.595 2.595 2.595 1.456 0 2.586-1.12 2.586-2.585zM13.64 31.748c1.465 0 2.604-1.14 2.604-2.585a2.581 2.581 0 0 0-2.595-2.605 2.567 2.567 0 0 0-2.595 2.595c-.01 1.475 1.101 2.595 2.586 2.595zm20.655-18.328H36.9c.258 0 .344-.077.268-.345a1.255 1.255 0 0 0-1.216-.929c-1.255-.01-2.5-.01-3.754-.01-.939 0-.833-.134-.852.862-.01.316.114.422.43.412.833 0 1.676.01 2.519.01zm6.215 9.93v-.46c0-.258-.192-.297-.364-.258-.316.067-.738-.23-.939.21-.076.182-.038.431.048.632.144.345.546.517 1.044.422.383-.067.134-.383.21-.546z' fill='%23000'/%3E%3Cpath d='M17.517 21.282c-.163.01-.335-.105-.498-.268-1.034-1.034-2.078-2.068-3.112-3.112-.335-.345-.355-.699-.067-.986.268-.278.65-.278.986.048.823.804 1.637 1.609 2.432 2.432.24.249.374.268.632.01 1.619-1.647 3.256-3.275 4.894-4.903.45-.44.814-.517 1.12-.22.316.296.249.708-.201 1.158-1.82 1.82-3.639 3.649-5.468 5.468-.182.182-.364.364-.718.373zM23.484 26.55H19.24c-.191 0-.383 0-.564-.068-.269-.095-.422-.287-.441-.565-.02-.297.134-.507.412-.622.153-.067.325-.067.488-.067h8.647c.163 0 .335 0 .489.067.258.105.411.297.411.584 0 .306-.153.508-.43.613-.173.067-.345.067-.527.067-1.408-.01-2.825-.01-4.242-.01zM8.393 22.604h3.754c.249 0 .488.029.66.23a.63.63 0 0 1-.316 1.034 2.533 2.533 0 0 1-.603.067H4.917c-.192 0-.383-.01-.565-.048-.335-.067-.546-.335-.517-.651.028-.354.239-.575.584-.603.354-.029.718-.02 1.072-.02.958-.009 1.935-.009 2.902-.009zM36.565 29.144c0 .709-.603 1.322-1.312 1.322-.708 0-1.321-.604-1.312-1.312 0-.68.613-1.293 1.293-1.302.7-.03 1.331.593 1.331 1.292zM13.64 30.466c-.699.01-1.302-.575-1.311-1.274-.02-.727.603-1.36 1.321-1.35.68.01 1.293.623 1.302 1.302.01.7-.593 1.312-1.312 1.322z' fill='%23000'/%3E%3C/svg%3E" alt="" />
                                </div>
                                <div >
                                    <h3>Standard Delivery</h3>
                                    <ul>
                                        <li className='li-css'><p>COD may be available*</p></li>
                                        <li className='li-css'><p>Free shipping on orders above 1500</p></li>
                                    </ul>
                                </div>
                            </div>
                            <div className="bus-div">
                                <div>
                                    <img src="data:image/svg+xml;charset=utf8,%3Csvg width='44' height='44' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M2.2 25.62c.181-.277.45-.402.775-.402h5.554c.134 0 .278.029.412.077.268.096.402.306.402.593 0 .288-.144.48-.412.594a1.406 1.406 0 0 1-.527.077H6.451c-.21 0-.326.057-.345.297-.086.967-.076.986.89.986.738 0 1.485-.01 2.222 0 .269.01.412-.086.527-.326.718-1.465 1.915-2.27 3.534-2.27 1.647 0 2.863.815 3.581 2.318.125.268.326.278.565.278h11.721c.536 0 .536 0 .536-.517V23.57c0-.144-.01-.287.02-.421.076-.326.287-.517.622-.517.316 0 .546.163.613.479.048.21.057.43.057.641.01 1.226 0 2.451.01 3.677 0 .125-.067.326.124.355.163.028.173-.163.22-.269.728-1.455 1.916-2.26 3.534-2.279 1.609-.019 2.806.766 3.543 2.203.153.297.316.402.642.402 1.1-.01 1.1 0 1.1-1.11 0-.374-.009-.738 0-1.112.01-.287-.104-.383-.382-.373a2.594 2.594 0 0 1-.9-.125c-.747-.258-1.178-.785-1.312-1.55-.086-.499-.067-.997-.048-1.495.029-.546.278-.766.843-.766.45 0 .89-.01 1.34 0 .316.01.316-.115.182-.335-.402-.66-1.005-.977-1.752-.986-2.26-.02-4.52 0-6.78-.01-.24 0-.354.086-.345.335a2.5 2.5 0 0 1-.048.46c-.076.326-.287.508-.622.508-.326.01-.584-.22-.632-.556-.02-.153-.02-.306-.02-.46V10.002c0-.508 0-.508-.507-.508H6.624c-.499 0-.499 0-.499.527v10.15c0 .192-.01.384-.048.575-.076.364-.344.565-.68.537-.335-.03-.564-.269-.593-.642-.01-.105-.01-.201-.01-.306V9.762c0-1.082.48-1.552 1.57-1.552h23.06c1.063 0 1.541.47 1.59 1.523.009.22.018.43 0 .651-.03.326.095.45.43.44 1.38-.019 2.758-.019 4.137 0 1.235.02 2.24.824 2.528 2.011.086.364.125.728.096 1.102-.01.2-.02.44-.182.565-.306.23-.24.488-.173.785.269 1.025.518 2.05.767 3.083.057.25.172.383.44.45 1.427.393 2.384 1.628 2.394 3.103.01 2.145.01 4.29 0 6.435 0 .575-.23.804-.814.814-.46.01-.92.01-1.379 0-.278-.01-.392.058-.43.374-.307 2.509-2.653 4.108-5.028 3.38-1.628-.498-2.547-1.676-2.787-3.361-.048-.326-.172-.393-.46-.383-4.29.01-8.58.01-12.87 0-.316 0-.43.086-.478.411-.287 1.81-1.446 3.074-3.103 3.429-2.25.478-4.5-1.16-4.702-3.457-.028-.307-.124-.393-.411-.383-.91.01-1.81.01-2.72 0-.948-.01-1.465-.537-1.475-1.475 0-.268-.01-.536 0-.804.01-.25-.095-.336-.344-.336-.46.01-.92 0-1.38 0-.354.01-.65-.095-.861-.392-.01-.201-.01-.374-.01-.556zm31.964-6.97c.92 0 1.838-.01 2.758 0 .297 0 .421-.058.335-.393-.278-1.044-.536-2.098-.795-3.151-.057-.249-.163-.364-.44-.364a371.4 371.4 0 0 1-4.626 0c-.306 0-.402.115-.402.402.01 1.025.01 2.04 0 3.065-.01.335.125.44.45.44.91-.01 1.82 0 2.72 0zm3.342 10.514c0-1.456-1.14-2.605-2.586-2.605a2.567 2.567 0 0 0-2.595 2.595c0 1.475 1.12 2.595 2.595 2.595 1.456 0 2.586-1.12 2.586-2.585zm-24.208 2.585c1.465 0 2.604-1.14 2.604-2.585a2.581 2.581 0 0 0-2.595-2.605 2.567 2.567 0 0 0-2.595 2.595c-.01 1.475 1.101 2.595 2.586 2.595zm20.655-18.328h2.605c.258 0 .345-.077.268-.345a1.255 1.255 0 0 0-1.216-.929c-1.255-.01-2.5-.01-3.754-.01-.939 0-.833-.134-.852.862-.01.316.115.422.43.412.834 0 1.676.01 2.52.01zm6.215 9.93v-.46c0-.258-.192-.297-.364-.258-.316.067-.737-.23-.938.21-.077.182-.039.431.047.632.144.345.546.517 1.044.422.383-.067.134-.383.21-.546z' fill='%23000'/%3E%3Cpath d='m20.703 15.029 2.922 2.435-2.921 2.434M16.809 15.029l2.921 2.435-2.92 2.434M12.912 15.029l2.922 2.435-2.921 2.434' stroke='%23000' stroke-linecap='round' stroke-linejoin='round'/%3E%3Cpath d='M23.142 26.55H18.9c-.192 0-.383 0-.565-.068-.268-.095-.422-.287-.44-.565-.02-.297.133-.507.41-.622.154-.067.326-.067.49-.067h8.646c.163 0 .336 0 .489.067.258.105.412.297.412.584 0 .306-.154.508-.431.613-.173.067-.345.067-.527.067-1.408-.01-2.825-.01-4.242-.01zM8.051 22.604h3.754c.249 0 .488.029.66.23a.63.63 0 0 1-.316 1.034 2.533 2.533 0 0 1-.603.067H4.575c-.192 0-.383-.01-.565-.048-.335-.067-.546-.335-.517-.651.029-.354.24-.575.584-.603.354-.029.718-.02 1.072-.02.958-.009 1.935-.009 2.902-.009zM36.224 29.144c0 .709-.604 1.322-1.312 1.322-.709 0-1.322-.604-1.312-1.312 0-.68.613-1.293 1.292-1.302.7-.03 1.331.593 1.331 1.292zM13.299 30.466c-.7.01-1.303-.575-1.312-1.274-.02-.727.603-1.36 1.321-1.35.68.01 1.293.623 1.303 1.302.01.7-.594 1.312-1.312 1.322z' fill='%23000'/%3E%3C/svg%3E" alt="" />
                                </div>
                                <div >
                                    <h3>Express Delivery available</h3>
                                    <ul>
                                        <li className='li-css'><p>Please enter a pincode to check availability of express delivery at your location</p></li>
                                    </ul>
                                </div>
                            </div>
                            <div className="bus-div">
                                <div>
                                    <img src="data:image/svg+xml;charset=utf8,%3Csvg width='24' height='24' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M9.702 2.952a3.25 3.25 0 0 1 5.547 2.236H8.751a3.25 3.25 0 0 1 .95-2.236zM7.75 6.312V8.25a.5.5 0 0 0 1 0V6.312h6.5V8.25a.5.5 0 0 0 1 0V6.312h2.684a.187.187 0 0 1 .18.136l1.14 3.99H3.746l1.14-3.99a.187.187 0 0 1 .18-.136H7.75zm0-1.125a4.25 4.25 0 0 1 8.5 0h2.684a1.313 1.313 0 0 1 1.262.952l1.341 4.694.026.17V12.5a3.563 3.563 0 0 1-1.5 2.905V21.5a1.313 1.313 0 0 1-1.313 1.313H5.25A1.312 1.312 0 0 1 3.937 21.5v-6.095a3.568 3.568 0 0 1-1.5-2.905v-1.503c0-.057.01-.112.026-.164l1.34-4.694a1.312 1.312 0 0 1 1.263-.952H7.75zm13.787 5.646.026.167v-.017l-.001-.009a.562.562 0 0 0-.025-.14zM15.563 12.5v-.938h4.874v.938a2.438 2.438 0 0 1-1.132 2.059.562.562 0 0 0-.165.096 2.436 2.436 0 0 1-3.578-2.155zM18 16.063c.32 0 .635-.043.938-.126V21.5a.188.188 0 0 1-.188.188H5.25a.187.187 0 0 1-.188-.188v-5.563A3.56 3.56 0 0 0 9 14.42a3.56 3.56 0 0 0 5.52.598c.182-.183.343-.383.48-.598a3.561 3.561 0 0 0 3 1.642zm-3.563-4.5v.937a2.438 2.438 0 1 1-4.874 0v-.938h4.874zm-6 .937v-.938H3.564v.938a2.437 2.437 0 0 0 1.132 2.059.562.562 0 0 1 .166.096A2.438 2.438 0 0 0 8.438 12.5z' fill='%23000'/%3E%3C/svg%3E" alt="" />
                                </div>
                                <div >
                                    <h3>Express Store Pickup available</h3>
                                    <ul>
                                        <li className='li-css'><p>Please select size to see availability of this product at your nearest store</p></li>
                                    </ul>
                                </div>
                            </div>
                            <div className="bus-div">
                                <div>
                                    <img src="data:image/svg+xml;charset=utf8,%3C?xml version='1.0' ?%3E%3Csvg data-name='Слой 1' id='Слой_1' viewBox='0 0 128 128' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle/%3E%3Cpath d='M64,0a64,64,0,1,0,64,64A64.07,64.07,0,0,0,64,0Zm0,124a60,60,0,1,1,60-60A60.07,60.07,0,0,1,64,124Z'/%3E%3Cpath d='M78.5,34h-48a2,2,0,0,0,0,4h48a21,21,0,0,1,0,42H35.33l18.6-18.58a2,2,0,0,0-2.83-2.84l-22,22-.08.1a1.2,1.2,0,0,0-.17.21l-.06.1-.13.24,0,.12c0,.09-.06.17-.08.25a2,2,0,0,0,0,.8c0,.08.05.16.08.25l0,.12.13.24.06.1a1.84,1.84,0,0,0,.17.22.73.73,0,0,1,.08.09l22,22a2,2,0,0,0,2.83,0,2,2,0,0,0,0-2.83L35.33,84H78.5a25,25,0,0,0,0-50Z'/%3E%3C/svg%3E" alt="" />
                                </div>
                                <div >
                                    <h3>14 days easy return and exchange applicable for this item</h3>
                                    <ul>
                                        <li className='li-css'><p>If you are not completely satisfied with your purchase, you can return most items to us within 14 days of delivery to get a 100% refund. We offer free and easy returns through courier pickup, or you can exchange most items bought online at any of our stores across India. All items to be returned or exchanged must be unused/untampered and in their original condition with original tags and packaging intact (eg. For shoes, please return the shoes in original shoes box packaging).</p></li>
                                    </ul>
                                </div>
                            </div>

                        </div>

                    </div>
                </div>
            </div>
        </>
    )
}

export default SingleProduct
